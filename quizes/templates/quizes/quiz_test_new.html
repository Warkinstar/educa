{% extends "base.html" %}
{% load crispy_forms_tags %}

{% block title %}
    {{ quiz }}
{% endblock title %}

{% block content %}
<h2 class="mb-4">Создание нового вопроса:</h2>
<p class="mb-2"><strong>Тема теста:</strong> {{ quiz.topic }}</p>
<p class="mb-2"><strong>Название теста:</strong> {{ quiz.title }}</p>
<p><strong>Создание вопроса номер:</strong> {{ quiz.questions.all.count|add:1 }}</p>

<form method="post">
  {% csrf_token %}
  <div class="mb-3">
    {{ question_form|crispy }}
  </div>
  <div class="card p-3">
    {{ answer_formset.management_form }}
    {{ answer_formset|crispy }}
  </div>
  <div class="mt-3">
    <button type="submit" class="btn btn-success" name="submit">Сохранить</button>
    <button type="submit" class="btn btn-primary" name="add-another">Сохранить и добавить еще</button>
  </div>
</form>

<br>

<div class="card">
  <div class="card-header">
    <h4>Существующие вопросы</h4>
  </div>
  <ul class="list-group list-group-flush">
    {% for question in quiz.questions.all %}
      <li class="list-group-item">
        <div class="d-flex justify-content-between align-items-center">
          <h5 class="m-0">{{ forloop.counter }}) {{ question }}</h5>
          <div class="btn-group" role="group">
            <a href="#" class="btn btn-sm btn-primary"><i class="bi bi-pencil"></i></a>
            <a href="#" class="btn btn-sm btn-danger"><i class="bi bi-trash"></i></a>
          </div>
        </div>
        <ul class="list-group list-group-flush mt-3">
          {% for answer in question.get_answers %}
            <li class="list-group-item">{{ answer.text }}{% if answer.correct %} <i class="bi bi-check-lg text-success"></i>{% endif %}</li>
          {% endfor %}
        </ul>
      </li>
    {% endfor %}
  </ul>
</div>


{% endblock %}

